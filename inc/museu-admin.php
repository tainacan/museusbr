<?php
if ( is_admin() && MUSEUSBR_ENABLE_MUSEU_ADMIN_PAGE ) {
    new MUSEUSBR_Museu_Admin_Page();
}

/**
 * MUSEUSBR_Museu_Admin_Page classe para criar e exibir a página do museu no admin
 */
class MUSEUSBR_Museu_Admin_Page {

    /**
     * O construtor criará o item de menu
     */
    public function __construct() {
        add_action( 'admin_menu', array($this, 'add_menu_museu_admin_menu'));
        add_action( 'admin_enqueue_scripts', array($this, 'admin_enqueue_styles'));
        add_filter( 'manage_' . museusbr_get_museus_collection_post_type() . '_posts_columns', array( $this, 'set_custom_museu_title_column' ), 30, 1);
        add_action( 'manage_' . museusbr_get_museus_collection_post_type() . '_posts_custom_column' , array( $this, 'museu_custom_title_column'), 10, 2 );
        add_filter( 'post_row_actions', array($this, 'remove_quick_edit'), 10, 2);
        add_filter( 'screen_options_show_screen', array( $this, 'remove_screen_options'), 10, 2 );
        add_filter( 'bulk_actions-edit-' . museusbr_get_museus_collection_post_type(), array($this, 'remove_bulk_actions'), 10, 1);
    }

    /**
     * O item de menu nos permitirá carregar a página para exibir o formulário
     */
    public function add_menu_museu_admin_menu() {
        add_submenu_page(
           '', // Definindo o parent como nulo para não criar um menu, apenas registrar a página
            'Museu',
            'Museu',
            'tnc_col_' . museusbr_get_museus_collection_id() . '_edit_items',
            'museu',
            array($this, 'render_museu_page')
        );
    }

    /**
     * Adiciona estilos personalizados
     */
    public function admin_enqueue_styles() {
        if (isset($_GET['page']) && $_GET['page'] === 'museu') {
            wp_enqueue_style('museusbr-museu-bulma', 'https://cdn.jsdelivr.net/npm/bulma@1.0.2/css/versions/bulma-no-dark-mode.min.css');
            wp_enqueue_style('museu-admin-page-styles', get_stylesheet_directory_uri() . '/assets/css/museu-admin-page.css');
        }
    }

    /**
     * Renderiza a página personalizada com um formulário
     */
    public function render_museu_page() {

        // Verificar se um post_id foi passado na URL
        if (!isset($_GET['post']) || empty($_GET['post'])) {
            return; // Se não houver post_id, algo deu errado no redirecionamento
        } else {
            $post_id = intval($_GET['post']);
        }

        $post = get_post($post_id);
        $item = tainacan_get_item( $post_id );

    ?>
        <div class="wrap">

            <div class="container py-4 is-fluid">

                <header class="museusbr-admin-header level is-flex-wrap-wrap">
                    <div class="level-left" style="flex-shrink: 1;">
                        <!-- Obtém thumbnail do Museu para mostrar, caso haja -->
                        <?php if (has_post_thumbnail($post)) : ?>
                            <figure class="image is-pulled-left mr-4" style="flex-shrink: 0;">
                                <?php echo get_the_post_thumbnail($post, 'tainacan-medium'); ?>
                            </figure>
                        <?php else : ?>
                            <figure class="image is-pulled-left mr-4" style="flex-shrink: 0;">
                            <svg width="45" xmlns="http://www.w3.org/2000/svg" height="45" viewBox="307 988 45 45" fill="none"><path d="M329.500,1029.000L329.500,1012.042M337.208,1029.000L337.208,1012.042M321.792,1029.000L321.792,1012.042M311.000,1004.333L329.500,992.000L348.000,1004.333M344.917,1029.000L344.917,1007.071C339.817,1006.273,334.662,1005.873,329.500,1005.875C324.256,1005.875,319.107,1006.286,314.083,1007.071L314.083,1029.000M311.000,1029.000L348.000,1029.000M329.500,999.708L329.500,999.708ZL329.500,999.708ZL329.500,999.708ZL329.500,999.708ZZ" style="fill: none;" class="fills"/><g stroke-linejoin="round" class="strokes"><path d="M329.500,1029.000L329.500,1012.042M337.208,1029.000L337.208,1012.042M321.792,1029.000L321.792,1012.042M311.000,1004.333L329.500,992.000L348.000,1004.333M344.917,1029.000L344.917,1007.071C339.817,1006.273,334.662,1005.873,329.500,1005.875C324.256,1005.875,319.107,1006.286,314.083,1007.071L314.083,1029.000M311.000,1029.000L348.000,1029.000M329.500,999.708L329.500,999.708ZL329.500,999.708ZL329.500,999.708ZL329.500,999.708ZZ" style="fill: none; stroke-width: 2.5; stroke: rgb(177, 178, 181); stroke-opacity: 1;" class="stroke-shape"/></g></svg>
                            </figure>
                        <?php endif; ?>
                        <h1 class="title is-1">
                            <?php echo ($post && $post->post_title ? $post->post_title : 'Página do Museu'); ?>
                        </h1>
                    </div>
                </header>

                <div class="museusbr-admin-inner-content">

                    <div class="museusbr-admin-info-area">
                        <?php
                            try {
                                // O metadado da instituição deve vir pré-preenchido
                                $codigo_metadatum = new \Tainacan\Entities\Metadatum( museusbr_get_codigo_identificador_ibram_metadatum_id() );

                                if ( $codigo_metadatum instanceof \Tainacan\Entities\Metadatum ) {
                                    
                                    $codigo_item_metadatum = new \Tainacan\Entities\Item_Metadata_Entity( $item, $codigo_metadatum );
                            
                                    if ( $codigo_item_metadatum->has_value() ) : ?>
                                        <span><strong>Código Identificador IBRAM:</strong> <?php echo $codigo_item_metadatum->get_value(); ?></span>
                                    <?php endif;
                                }

                            } catch (Exception $e) {
                                error_log('Erro ao tentar acessar o metadado do Código de Identificação do Ibram: ' . $e->getMessage());
                            }
                        ?>
                        <span><strong>Cadastrado por:</strong> <?php echo get_the_author_meta('display_name', $post->post_author); ?></span>
                        <span><strong>Data de cadastro:</strong> <?php echo get_the_date('d/m/Y', $post->ID); ?></span>
                    </div>

                    <div class="columns is-multiline is-6 is-2-mobile">

                        <div class="column">
                            <?php $this->museusbr_get_cadastro_card($post); ?>
                        </div>

                        <?php if ( MUSEUSBR_ENABLE_REGISTRO ) : ?>
                            <div class="column">
                                <?php $this->museusbr_get_registro_card($post); ?>
                            </div>
                        <?php endif; ?>

                        <?php if ( MUSEUSBR_ENABLE_FORMULARIO_VISITACAO ) : ?>
                            <div class="column is-full">
                                <?php $this->museusbr_get_formulario_visitacao_card($post); ?>
                            </div>
                        <?php endif; ?>

                    </div>

                </div>
            </div>
        </div>
    <?php

    }

    /**
     * Gera o cartão do cadastro
     */
    function museusbr_get_cadastro_card( $post ) {
        $post_status_slug = get_post_status($post);
        $post_status_label = $post_status_slug;
        
        ?>
        <div class="card">
            <div class="card-header">
                <div class="card-header-icon">
                    <span class="icon">
                        <svg width="45" xmlns="http://www.w3.org/2000/svg" height="45" viewBox="307 988 45 45" fill="none"><path d="M329.500,1029.000L329.500,1012.042M337.208,1029.000L337.208,1012.042M321.792,1029.000L321.792,1012.042M311.000,1004.333L329.500,992.000L348.000,1004.333M344.917,1029.000L344.917,1007.071C339.817,1006.273,334.662,1005.873,329.500,1005.875C324.256,1005.875,319.107,1006.286,314.083,1007.071L314.083,1029.000M311.000,1029.000L348.000,1029.000M329.500,999.708L329.500,999.708ZL329.500,999.708ZL329.500,999.708ZL329.500,999.708ZZ" style="fill: none;" class="fills"/><g stroke-linejoin="round" class="strokes"><path d="M329.500,1029.000L329.500,1012.042M337.208,1029.000L337.208,1012.042M321.792,1029.000L321.792,1012.042M311.000,1004.333L329.500,992.000L348.000,1004.333M344.917,1029.000L344.917,1007.071C339.817,1006.273,334.662,1005.873,329.500,1005.875C324.256,1005.875,319.107,1006.286,314.083,1007.071L314.083,1029.000M311.000,1029.000L348.000,1029.000M329.500,999.708L329.500,999.708ZL329.500,999.708ZL329.500,999.708ZL329.500,999.708ZZ" style="fill: none; stroke-width: 2.5; stroke: rgb(255, 255, 255); stroke-opacity: 1;" class="stroke-shape"/></g></svg>
                    </span>
                </div>
                <div class="card-header-title">
                    <h2>Meu Cadastro</h2>
                    <span class="tag ml-auto mr-3 has-text-white <?php echo 'is-' . $this->get_color_class_by_status($post_status_slug); ?>">
                        <?php echo $post_status_label ? $this->get_label_by_status($post_status_slug) : 'Novo cadastro'; ?>
                    </span>
                </div>
            </div>
            <div class="card-content content">
            Criado em 2006, no âmbito da Política Nacional de Museus, o Cadastro Nacional de Museus (CNM) reúne e sistematiza informações sobre os museus brasileiros. De caráter auto declaratório, seus dados são essenciais para a gestão, pesquisa e formulação e monitoramento de políticas públicas do setor museológico e da cultura.
            </div>
            <div class="card-content card-links">
                <?php if ( current_user_can( 'edit_post', $post->ID ) ) : ?>
                    <a class="card-links-button" style="white-space: wrap" href="<?php echo get_edit_post_link( $post->ID ); ?>">
                        <span class="icon">
                            <svg width="40" xmlns="http://www.w3.org/2000/svg" height="40" viewBox="376 1246 40 40" fill="none"><path d="M396.000,1283.000L396.000,1267.417M403.083,1283.000L403.083,1267.417M388.917,1283.000L388.917,1267.417M379.000,1260.333L396.000,1249.000L413.000,1260.333M410.167,1283.000L410.167,1262.849C405.480,1262.116,400.744,1261.748,396.000,1261.750C391.181,1261.750,386.450,1262.128,381.833,1262.849L381.833,1283.000M379.000,1283.000L413.000,1283.000M396.000,1256.083L396.000,1256.083ZL396.000,1256.083ZL396.000,1256.083ZL396.000,1256.083ZZ" style="fill: none;" class="fills"/><g stroke-linejoin="round" class="strokes"><path d="M396.000,1283.000L396.000,1267.417M403.083,1283.000L403.083,1267.417M388.917,1283.000L388.917,1267.417M379.000,1260.333L396.000,1249.000L413.000,1260.333M410.167,1283.000L410.167,1262.849C405.480,1262.116,400.744,1261.748,396.000,1261.750C391.181,1261.750,386.450,1262.128,381.833,1262.849L381.833,1283.000M379.000,1283.000L413.000,1283.000M396.000,1256.083L396.000,1256.083ZL396.000,1256.083ZL396.000,1256.083ZL396.000,1256.083ZZ" style="fill: none; stroke-width: 2; stroke: rgb(29, 45, 48); stroke-opacity: 1;" class="stroke-shape"/></g></svg>
                        </span>
                        <span>Editar cadastro</span>
                    </a>
                    <!-- <p class="card-links-button card-links-button--registro has-text-warning">
                        <span class="icon">
                            <svg width="35" xmlns="http://www.w3.org/2000/svg" height="31" fill="none"><path d="M19.000,23.500C19.000,24.328,18.328,25.000,17.500,25.000C16.672,25.000,16.000,24.328,16.000,23.500C16.000,22.672,16.672,22.000,17.500,22.000C18.328,22.000,19.000,22.672,19.000,23.500ZM18.625,11.125C18.625,10.504,18.121,10.000,17.500,10.000C16.879,10.000,16.375,10.504,16.375,11.125L16.375,17.875C16.375,18.496,16.879,19.000,17.500,19.000C18.121,19.000,18.625,18.496,18.625,17.875Z" style="fill: rgb(252, 136, 2); fill-opacity: 1;" class="fills"/><path d="M14.198,1.888C15.668,-0.629,19.332,-0.629,20.802,1.888L34.483,25.328C35.952,27.848,34.117,31.000,31.180,31.000L3.821,31.000C0.882,31.000,-0.952,27.848,0.517,25.328ZM18.821,3.023C18.548,2.557,18.044,2.270,17.500,2.270C16.956,2.270,16.453,2.557,16.179,3.023L2.499,26.463C2.228,26.931,2.229,27.507,2.501,27.974C2.773,28.442,3.276,28.731,3.821,28.732L31.180,28.732C31.724,28.730,32.226,28.442,32.498,27.975C32.770,27.508,32.771,26.932,32.501,26.464L18.821,3.023ZZ" style="fill: rgb(252, 136, 2); fill-opacity: 1;" class="fills"/></svg>
                        </span>
                        <strong class="has-text-warning">Campos obrigatórios requerem sua atenção.</strong>
                    </p> -->
                <?php endif; ?>
                <a class="card-links-button" style="white-space: wrap" href="<?php echo get_post_permalink( $post->ID ); ?>">
                    <span class="icon">
                        <svg width="36" xmlns="http://www.w3.org/2000/svg" height="26" viewBox="378 1336 36 26" fill="none"><path d="M413.929,1348.598C411.044,1341.249,403.995,1336.296,396.000,1336.000C388.005,1336.296,380.956,1341.249,378.071,1348.598C377.976,1348.858,377.976,1349.142,378.071,1349.402C380.956,1356.751,388.005,1361.704,396.000,1362.000C403.995,1361.704,411.044,1356.751,413.929,1349.402C414.024,1349.142,414.024,1348.858,413.929,1348.598ZM396.000,1359.636C389.640,1359.636,382.920,1354.992,380.484,1349.000C382.920,1343.008,389.640,1338.364,396.000,1338.364C402.360,1338.364,409.080,1343.008,411.516,1349.000C409.080,1354.992,402.360,1359.636,396.000,1359.636ZM396.000,1341.909C392.023,1341.909,388.800,1345.084,388.800,1349.000C388.800,1352.916,392.023,1356.091,396.000,1356.091C399.977,1356.091,403.200,1352.916,403.200,1349.000C403.200,1345.084,399.977,1341.909,396.000,1341.909ZM396.000,1353.727C393.349,1353.727,391.200,1351.611,391.200,1349.000C391.200,1346.389,393.349,1344.273,396.000,1344.273C398.651,1344.273,400.800,1346.389,400.800,1349.000C400.800,1351.611,398.651,1353.727,396.000,1353.727Z" style="fill: rgb(29, 45, 48); fill-opacity: 1;" class="fills"/></svg>
                    </span>
                    <span>Página pública do cadastro</span>
                </a>
                <?php if ( MUSEUSBR_ENABLE_CERTIFICADO_CADASTRO && get_post_status( $post ) === 'publish' ) :
                    $certificado_icon = '<svg width="33" xmlns="http://www.w3.org/2000/svg" height="37" viewBox="379 1413 33 37" fill="none"><path d="M395.500,1413.000C394.652,1413.000,393.809,1413.299,393.083,1413.845L390.835,1415.490L388.245,1415.846L388.203,1415.846L388.161,1415.890C386.427,1416.299,385.072,1417.719,384.682,1419.538L384.641,1419.582L384.641,1419.626L384.302,1422.384L382.733,1424.518L382.689,1424.563L382.689,1424.607C381.740,1426.196,381.698,1428.248,382.733,1429.765L384.344,1432.122L384.769,1434.570L380.399,1441.550L379.000,1443.730L385.490,1443.730L387.059,1447.554L388.035,1450.000L389.434,1447.776L393.718,1441.016C394.869,1441.511,396.168,1441.557,397.282,1441.016L401.566,1447.776L402.965,1450.000L403.941,1447.554L405.510,1443.730L412.000,1443.730L410.601,1441.550L406.359,1434.792L406.698,1432.123L408.267,1429.767L408.311,1429.723L408.311,1429.678C409.260,1428.089,409.302,1426.081,408.267,1424.564L406.698,1422.206L406.189,1419.538L406.231,1419.538C406.226,1419.503,406.195,1419.481,406.189,1419.448C405.945,1417.587,404.540,1416.075,402.754,1415.846L402.710,1415.846L400.165,1415.490L397.917,1413.845C397.216,1413.306,396.370,1413.010,395.500,1413.000ZM395.500,1415.890C395.812,1415.890,396.120,1415.990,396.348,1416.158L398.766,1417.981L399.063,1418.203L399.402,1418.248L402.372,1418.692L402.413,1418.692C403.024,1418.763,403.447,1419.209,403.517,1419.849L403.517,1419.938L404.069,1423.095L404.110,1423.407L404.323,1423.673L406.062,1426.208C406.386,1426.680,406.428,1427.481,406.019,1428.164L404.111,1430.966L404.068,1431.322L403.644,1434.436L403.644,1434.479C403.621,1434.701,403.549,1434.914,403.432,1435.102L403.347,1435.147L403.347,1435.190C403.145,1435.444,402.856,1435.604,402.542,1435.635L402.456,1435.635L399.360,1436.215L399.021,1436.257L398.766,1436.481L396.348,1438.304C395.898,1438.644,395.091,1438.688,394.440,1438.260L392.234,1436.481L391.979,1436.259L391.598,1436.213L388.628,1435.769L388.587,1435.769C388.198,1435.732,387.850,1435.500,387.653,1435.146C387.563,1434.982,387.506,1434.800,387.483,1434.612L387.483,1434.524L386.932,1431.278L386.889,1430.922L386.677,1430.655L384.938,1428.120C384.614,1427.648,384.572,1426.802,384.981,1426.119L386.677,1423.807L386.889,1423.539L386.931,1423.139L387.314,1420.160C387.319,1420.138,387.350,1420.138,387.356,1420.115C387.530,1419.419,388.049,1418.875,388.713,1418.692C388.735,1418.687,388.735,1418.654,388.755,1418.648L391.598,1418.247L391.937,1418.204L392.234,1417.981L394.652,1416.158C394.880,1415.991,395.188,1415.890,395.500,1415.890ZM404.874,1437.548L406.953,1440.884L403.685,1440.884L403.346,1441.773L402.413,1444.040L399.529,1439.415L400.164,1438.927L402.838,1438.438L402.838,1438.482C402.869,1438.476,402.889,1438.443,402.922,1438.438C403.636,1438.329,404.310,1438.022,404.874,1437.548ZZM386.126,1437.592C386.716,1438.154,387.456,1438.511,388.246,1438.615L388.288,1438.615L390.877,1438.971L391.470,1439.461L388.586,1444.040L387.653,1441.773L387.314,1440.884L384.048,1440.884Z" style="fill: rgb(29, 45, 48); fill-opacity: 1;" class="fills"/></svg>';
                    MUSEUSBR_Certificado_Page::render_certificado_button( $post, 'card-links-button', $certificado_icon ); 
                endif; ?>
            </div>
        </div>
        <?php
    }

    /**
     * Gera o cartão do registro
     */
    function museusbr_get_registro_card( $post ) {

        $query_params = array(
            'post_type' => 'registro',
            'post_status' => array( 'trash', 'pending', 'draft', 'private', 'publish', 'auto-draft' ),
            'posts_per_page' => 1,
            'orderby' => 'modified',
            'order' => 'DESC',
            'meta_query' => array(
                array(
                    'key' => 'registro_museu_id',
                    'value' => $post->ID,
                    'compare' => '='
                )
            )
        );

        $query = new WP_Query($query_params);
        $meta_results = $query->posts;

        $registro_status_slug = '';
        $registro_status_label = 'Não iniciado';

        if ( $meta_results &&  count($meta_results) > 0 ) {
            $registro_status_slug = get_post_status($meta_results[0]);
            $registro_status_label = museusbr_get_registro_status_label($registro_status_slug);
        }

        ?>
        <div class="card">
            <div class="card-header">
                <div class="card-header-icon">
                    <span class="icon">
                        <svg width="32" xmlns="http://www.w3.org/2000/svg" height="32" viewBox="845 995 32 32" fill="none"><path d="M848.431,996.714C848.431,995.764,847.666,995.000,846.715,995.000C845.765,995.000,845.000,995.764,845.000,996.714L845.000,1025.286C845.000,1026.236,845.765,1027.000,846.715,1027.000C847.666,1027.000,848.431,1026.236,848.431,1025.286L848.431,1001.586L849.324,1001.414C850.518,1001.186,851.576,1000.807,852.484,1000.479L852.484,1000.479L852.484,1000.479C852.748,1000.386,852.991,1000.293,853.227,1000.214C854.313,999.843,855.400,999.564,856.887,999.564C858.716,999.564,859.960,999.993,861.425,1000.514L861.461,1000.529C862.955,1001.057,864.663,1001.664,867.115,1001.664C869.423,1001.664,870.953,1001.179,873.583,1000.264L873.583,1017.207L872.904,1017.443C869.938,1018.471,868.959,1018.814,867.115,1018.814C865.278,1018.814,864.034,1018.386,862.569,1017.864L862.526,1017.850C861.039,1017.321,859.324,1016.721,856.879,1016.721C855.679,1016.721,854.664,1016.864,853.742,1017.079C852.820,1017.293,852.248,1018.221,852.462,1019.143C852.677,1020.064,853.606,1020.636,854.528,1020.421C855.214,1020.264,855.964,1020.157,856.879,1020.157C858.709,1020.157,859.953,1020.586,861.418,1021.107L861.454,1021.121C862.948,1021.650,864.656,1022.257,867.108,1022.257C869.566,1022.257,871.139,1021.707,874.098,1020.671C874.634,1020.486,875.206,1020.286,875.842,1020.064L877.000,1019.671L877.000,1018.429L877.000,997.857L877.000,995.457L874.748,996.236C874.055,996.471,873.448,996.686,872.912,996.871C869.945,997.900,868.966,998.243,867.122,998.243C865.285,998.243,864.041,997.814,862.576,997.293L862.533,997.279C861.046,996.750,859.331,996.150,856.887,996.150C854.899,996.150,853.420,996.543,852.126,996.979C851.776,997.100,851.461,997.214,851.154,997.321C850.304,997.629,849.582,997.886,848.674,998.057L848.431,998.100L848.431,996.714ZL848.431,996.714Z" style="fill: rgb(255, 255, 255); fill-opacity: 1;" class="fills"/></svg>
                    </span>
                </div>
                <div class="card-header-title">
                    <h2>Meu Registro</h2>
                    <span class="tag mr-3 ml-auto has-text-white <?php echo 'is-' . $this->get_color_class_by_status($registro_status_slug); ?>">
                        <?php echo $registro_status_label; ?>
                    </span>
                </div>
            </div>
            <div class="card-content content">
            O Registro de Museus visa estimular a formalização dos museus, acompanhando suas dinâmicas de criação, fusão, extinção, incorporação e cisão. É obrigatório para todos os museus do Brasil, conforme o Estatuto de Museus e a legislação vigente. Por meio dele, os museus podem aderir ao Sistema Brasileiro de Museus (SBM) e fortalecem a Política Nacional de Museus
            </div>
            <div class="card-content card-links card-links--registro">
                <?php

                    if ( !empty($meta_results) ) {
                        foreach ($meta_results as $registro) {
                            
                            echo '<span>Solicitação #' . $registro->ID . '</span>';

                            $registro_status = get_post_status($registro);
                            
                            switch ($registro_status) {
                                case 'draft':
                                    echo '<a class="card-links-button" style="white-space: wrap" href="' . admin_url('admin.php?page=registro&post=' . $registro->ID) . '">';
                                    echo '<span class="icon" style="color: ' . $this->get_color_by_status($registro_status) . ';"><svg width="28" xmlns="http://www.w3.org/2000/svg" height="28" viewBox="-105 2129 28 28" fill="none"><path d="M-101.998,2130.500C-101.998,2129.669,-102.667,2129.000,-103.499,2129.000C-104.331,2129.000,-105.000,2129.669,-105.000,2130.500L-105.000,2155.500C-105.000,2156.331,-104.331,2157.000,-103.499,2157.000C-102.667,2157.000,-101.998,2156.331,-101.998,2155.500L-101.998,2134.763L-101.216,2134.612C-100.172,2134.412,-99.246,2134.081,-98.452,2133.794L-98.452,2133.794L-98.452,2133.794C-98.220,2133.713,-98.008,2133.631,-97.801,2133.562C-96.851,2133.237,-95.900,2132.994,-94.599,2132.994C-92.998,2132.994,-91.910,2133.369,-90.628,2133.825L-90.597,2133.838C-89.289,2134.300,-87.795,2134.831,-85.650,2134.831C-83.629,2134.831,-82.291,2134.406,-79.990,2133.606L-79.990,2148.431L-80.584,2148.637C-83.179,2149.537,-84.036,2149.837,-85.650,2149.837C-87.257,2149.837,-88.345,2149.463,-89.627,2149.006L-89.665,2148.994C-90.966,2148.531,-92.467,2148.006,-94.606,2148.006C-95.656,2148.006,-96.544,2148.131,-97.351,2148.319C-98.158,2148.506,-98.658,2149.319,-98.471,2150.125C-98.283,2150.931,-97.470,2151.431,-96.663,2151.244C-96.063,2151.106,-95.406,2151.012,-94.606,2151.012C-93.004,2151.012,-91.916,2151.388,-90.634,2151.844L-90.603,2151.856C-89.296,2152.319,-87.801,2152.850,-85.656,2152.850C-83.504,2152.850,-82.128,2152.369,-79.539,2151.463C-79.070,2151.300,-78.570,2151.125,-78.013,2150.931L-77.000,2150.588L-77.000,2149.500L-77.000,2131.500L-77.000,2129.400L-78.970,2130.081C-79.577,2130.287,-80.108,2130.475,-80.577,2130.637C-83.173,2131.537,-84.030,2131.837,-85.643,2131.837C-87.251,2131.837,-88.339,2131.462,-89.621,2131.006L-89.658,2130.994C-90.959,2130.531,-92.460,2130.006,-94.599,2130.006C-96.338,2130.006,-97.633,2130.350,-98.765,2130.731C-99.071,2130.838,-99.346,2130.937,-99.615,2131.031C-100.359,2131.300,-100.991,2131.525,-101.785,2131.675L-101.998,2131.713L-101.998,2130.500ZL-101.998,2130.500Z" style="fill: currentColor; fill-opacity: 1;" class="fills"/></svg></span>';
                                    echo '<span>Continuar preenchendo</span>';
                                    echo '</a>';
                                    break;

                                case 'pending':

                                    if ( current_user_can('publish_posts', $registro->ID) ) {
                                        echo '<a class="card-links-button" style="white-space: wrap" href="' . admin_url('admin.php?page=registro&post=' . $registro->ID) . '">';
                                        echo '<span class="icon" style="color: ' . $this->get_color_by_status($registro_status) . ';"><svg width="28" xmlns="http://www.w3.org/2000/svg" height="28" viewBox="-105 2129 28 28" fill="none"><path d="M-101.998,2130.500C-101.998,2129.669,-102.667,2129.000,-103.499,2129.000C-104.331,2129.000,-105.000,2129.669,-105.000,2130.500L-105.000,2155.500C-105.000,2156.331,-104.331,2157.000,-103.499,2157.000C-102.667,2157.000,-101.998,2156.331,-101.998,2155.500L-101.998,2134.763L-101.216,2134.612C-100.172,2134.412,-99.246,2134.081,-98.452,2133.794L-98.452,2133.794L-98.452,2133.794C-98.220,2133.713,-98.008,2133.631,-97.801,2133.562C-96.851,2133.237,-95.900,2132.994,-94.599,2132.994C-92.998,2132.994,-91.910,2133.369,-90.628,2133.825L-90.597,2133.838C-89.289,2134.300,-87.795,2134.831,-85.650,2134.831C-83.629,2134.831,-82.291,2134.406,-79.990,2133.606L-79.990,2148.431L-80.584,2148.637C-83.179,2149.537,-84.036,2149.837,-85.650,2149.837C-87.257,2149.837,-88.345,2149.463,-89.627,2149.006L-89.665,2148.994C-90.966,2148.531,-92.467,2148.006,-94.606,2148.006C-95.656,2148.006,-96.544,2148.131,-97.351,2148.319C-98.158,2148.506,-98.658,2149.319,-98.471,2150.125C-98.283,2150.931,-97.470,2151.431,-96.663,2151.244C-96.063,2151.106,-95.406,2151.012,-94.606,2151.012C-93.004,2151.012,-91.916,2151.388,-90.634,2151.844L-90.603,2151.856C-89.296,2152.319,-87.801,2152.850,-85.656,2152.850C-83.504,2152.850,-82.128,2152.369,-79.539,2151.463C-79.070,2151.300,-78.570,2151.125,-78.013,2150.931L-77.000,2150.588L-77.000,2149.500L-77.000,2131.500L-77.000,2129.400L-78.970,2130.081C-79.577,2130.287,-80.108,2130.475,-80.577,2130.637C-83.173,2131.537,-84.030,2131.837,-85.643,2131.837C-87.251,2131.837,-88.339,2131.462,-89.621,2131.006L-89.658,2130.994C-90.959,2130.531,-92.460,2130.006,-94.599,2130.006C-96.338,2130.006,-97.633,2130.350,-98.765,2130.731C-99.071,2130.838,-99.346,2130.937,-99.615,2131.031C-100.359,2131.300,-100.991,2131.525,-101.785,2131.675L-101.998,2131.713L-101.998,2130.500ZL-101.998,2130.500Z" style="fill: currentColor; fill-opacity: 1;" class="fills"/></svg></span>';
                                        echo '<span>Analisar</span>';
                                        echo '</a>';
                                    }
                                    break;

                                case 'private':
                                    echo '<a class="card-links-button" style="white-space: wrap" href="' . admin_url('admin.php?page=registro&post=' . $registro->ID) . '">';
                                    echo '<span class="icon" style="color: ' . $this->get_color_by_status($registro_status) . ';"><svg width="28" xmlns="http://www.w3.org/2000/svg" height="28" viewBox="-105 2129 28 28" fill="none"><path d="M-101.998,2130.500C-101.998,2129.669,-102.667,2129.000,-103.499,2129.000C-104.331,2129.000,-105.000,2129.669,-105.000,2130.500L-105.000,2155.500C-105.000,2156.331,-104.331,2157.000,-103.499,2157.000C-102.667,2157.000,-101.998,2156.331,-101.998,2155.500L-101.998,2134.763L-101.216,2134.612C-100.172,2134.412,-99.246,2134.081,-98.452,2133.794L-98.452,2133.794L-98.452,2133.794C-98.220,2133.713,-98.008,2133.631,-97.801,2133.562C-96.851,2133.237,-95.900,2132.994,-94.599,2132.994C-92.998,2132.994,-91.910,2133.369,-90.628,2133.825L-90.597,2133.838C-89.289,2134.300,-87.795,2134.831,-85.650,2134.831C-83.629,2134.831,-82.291,2134.406,-79.990,2133.606L-79.990,2148.431L-80.584,2148.637C-83.179,2149.537,-84.036,2149.837,-85.650,2149.837C-87.257,2149.837,-88.345,2149.463,-89.627,2149.006L-89.665,2148.994C-90.966,2148.531,-92.467,2148.006,-94.606,2148.006C-95.656,2148.006,-96.544,2148.131,-97.351,2148.319C-98.158,2148.506,-98.658,2149.319,-98.471,2150.125C-98.283,2150.931,-97.470,2151.431,-96.663,2151.244C-96.063,2151.106,-95.406,2151.012,-94.606,2151.012C-93.004,2151.012,-91.916,2151.388,-90.634,2151.844L-90.603,2151.856C-89.296,2152.319,-87.801,2152.850,-85.656,2152.850C-83.504,2152.850,-82.128,2152.369,-79.539,2151.463C-79.070,2151.300,-78.570,2151.125,-78.013,2150.931L-77.000,2150.588L-77.000,2149.500L-77.000,2131.500L-77.000,2129.400L-78.970,2130.081C-79.577,2130.287,-80.108,2130.475,-80.577,2130.637C-83.173,2131.537,-84.030,2131.837,-85.643,2131.837C-87.251,2131.837,-88.339,2131.462,-89.621,2131.006L-89.658,2130.994C-90.959,2130.531,-92.460,2130.006,-94.599,2130.006C-96.338,2130.006,-97.633,2130.350,-98.765,2130.731C-99.071,2130.838,-99.346,2130.937,-99.615,2131.031C-100.359,2131.300,-100.991,2131.525,-101.785,2131.675L-101.998,2131.713L-101.998,2130.500ZL-101.998,2130.500Z" style="fill: currentColor; fill-opacity: 1;" class="fills"/></svg></span>';
                                    echo '<span>Verificar pendências</span>';
                                    echo '</a>';
                                    break;

                                case 'publish':

                                    if ( MUSEUSBR_ENABLE_CERTIFICADO_REGISTRO ) {
                                        $certificado_icon = '<svg width="33" xmlns="http://www.w3.org/2000/svg" height="37" viewBox="379 1413 33 37" fill="none"><path d="M395.500,1413.000C394.652,1413.000,393.809,1413.299,393.083,1413.845L390.835,1415.490L388.245,1415.846L388.203,1415.846L388.161,1415.890C386.427,1416.299,385.072,1417.719,384.682,1419.538L384.641,1419.582L384.641,1419.626L384.302,1422.384L382.733,1424.518L382.689,1424.563L382.689,1424.607C381.740,1426.196,381.698,1428.248,382.733,1429.765L384.344,1432.122L384.769,1434.570L380.399,1441.550L379.000,1443.730L385.490,1443.730L387.059,1447.554L388.035,1450.000L389.434,1447.776L393.718,1441.016C394.869,1441.511,396.168,1441.557,397.282,1441.016L401.566,1447.776L402.965,1450.000L403.941,1447.554L405.510,1443.730L412.000,1443.730L410.601,1441.550L406.359,1434.792L406.698,1432.123L408.267,1429.767L408.311,1429.723L408.311,1429.678C409.260,1428.089,409.302,1426.081,408.267,1424.564L406.698,1422.206L406.189,1419.538L406.231,1419.538C406.226,1419.503,406.195,1419.481,406.189,1419.448C405.945,1417.587,404.540,1416.075,402.754,1415.846L402.710,1415.846L400.165,1415.490L397.917,1413.845C397.216,1413.306,396.370,1413.010,395.500,1413.000ZM395.500,1415.890C395.812,1415.890,396.120,1415.990,396.348,1416.158L398.766,1417.981L399.063,1418.203L399.402,1418.248L402.372,1418.692L402.413,1418.692C403.024,1418.763,403.447,1419.209,403.517,1419.849L403.517,1419.938L404.069,1423.095L404.110,1423.407L404.323,1423.673L406.062,1426.208C406.386,1426.680,406.428,1427.481,406.019,1428.164L404.111,1430.966L404.068,1431.322L403.644,1434.436L403.644,1434.479C403.621,1434.701,403.549,1434.914,403.432,1435.102L403.347,1435.147L403.347,1435.190C403.145,1435.444,402.856,1435.604,402.542,1435.635L402.456,1435.635L399.360,1436.215L399.021,1436.257L398.766,1436.481L396.348,1438.304C395.898,1438.644,395.091,1438.688,394.440,1438.260L392.234,1436.481L391.979,1436.259L391.598,1436.213L388.628,1435.769L388.587,1435.769C388.198,1435.732,387.850,1435.500,387.653,1435.146C387.563,1434.982,387.506,1434.800,387.483,1434.612L387.483,1434.524L386.932,1431.278L386.889,1430.922L386.677,1430.655L384.938,1428.120C384.614,1427.648,384.572,1426.802,384.981,1426.119L386.677,1423.807L386.889,1423.539L386.931,1423.139L387.314,1420.160C387.319,1420.138,387.350,1420.138,387.356,1420.115C387.530,1419.419,388.049,1418.875,388.713,1418.692C388.735,1418.687,388.735,1418.654,388.755,1418.648L391.598,1418.247L391.937,1418.204L392.234,1417.981L394.652,1416.158C394.880,1415.991,395.188,1415.890,395.500,1415.890ZM404.874,1437.548L406.953,1440.884L403.685,1440.884L403.346,1441.773L402.413,1444.040L399.529,1439.415L400.164,1438.927L402.838,1438.438L402.838,1438.482C402.869,1438.476,402.889,1438.443,402.922,1438.438C403.636,1438.329,404.310,1438.022,404.874,1437.548ZZM386.126,1437.592C386.716,1438.154,387.456,1438.511,388.246,1438.615L388.288,1438.615L390.877,1438.971L391.470,1439.461L388.586,1444.040L387.653,1441.773L387.314,1440.884L384.048,1440.884Z" style="fill: rgb(29, 45, 48); fill-opacity: 1;" class="fills"/></svg>';
                                        \MUSEUSBR_Certificado_Registro_Page::render_certificado_button( $registro, 'card-links-button cards-links-button-certificado', $certificado_icon );
                                    } else {

                                        $certificado_registro = get_post_meta($registro->ID, 'certificado_registro', true);
                                        if ( $certificado_registro ) {
                                            echo '<a class="card-links-button" style="white-space: wrap" download="' . add_query_arg('file_id', $certificado_registro, get_stylesheet_directory_uri() . '/inc/registro-serve-file.php') . '" href="' . add_query_arg('file_id', $certificado_registro, get_stylesheet_directory_uri() . '/inc/registro-serve-file.php') . '">';
                                            echo '<span class="icon" style="color: ' . $this->get_color_by_status($registro_status) . ';"><svg width="33" xmlns="http://www.w3.org/2000/svg" height="37" viewBox="379 1413 33 37" fill="none"><path d="M395.500,1413.000C394.652,1413.000,393.809,1413.299,393.083,1413.845L390.835,1415.490L388.245,1415.846L388.203,1415.846L388.161,1415.890C386.427,1416.299,385.072,1417.719,384.682,1419.538L384.641,1419.582L384.641,1419.626L384.302,1422.384L382.733,1424.518L382.689,1424.563L382.689,1424.607C381.740,1426.196,381.698,1428.248,382.733,1429.765L384.344,1432.122L384.769,1434.570L380.399,1441.550L379.000,1443.730L385.490,1443.730L387.059,1447.554L388.035,1450.000L389.434,1447.776L393.718,1441.016C394.869,1441.511,396.168,1441.557,397.282,1441.016L401.566,1447.776L402.965,1450.000L403.941,1447.554L405.510,1443.730L412.000,1443.730L410.601,1441.550L406.359,1434.792L406.698,1432.123L408.267,1429.767L408.311,1429.723L408.311,1429.678C409.260,1428.089,409.302,1426.081,408.267,1424.564L406.698,1422.206L406.189,1419.538L406.231,1419.538C406.226,1419.503,406.195,1419.481,406.189,1419.448C405.945,1417.587,404.540,1416.075,402.754,1415.846L402.710,1415.846L400.165,1415.490L397.917,1413.845C397.216,1413.306,396.370,1413.010,395.500,1413.000ZM395.500,1415.890C395.812,1415.890,396.120,1415.990,396.348,1416.158L398.766,1417.981L399.063,1418.203L399.402,1418.248L402.372,1418.692L402.413,1418.692C403.024,1418.763,403.447,1419.209,403.517,1419.849L403.517,1419.938L404.069,1423.095L404.110,1423.407L404.323,1423.673L406.062,1426.208C406.386,1426.680,406.428,1427.481,406.019,1428.164L404.111,1430.966L404.068,1431.322L403.644,1434.436L403.644,1434.479C403.621,1434.701,403.549,1434.914,403.432,1435.102L403.347,1435.147L403.347,1435.190C403.145,1435.444,402.856,1435.604,402.542,1435.635L402.456,1435.635L399.360,1436.215L399.021,1436.257L398.766,1436.481L396.348,1438.304C395.898,1438.644,395.091,1438.688,394.440,1438.260L392.234,1436.481L391.979,1436.259L391.598,1436.213L388.628,1435.769L388.587,1435.769C388.198,1435.732,387.850,1435.500,387.653,1435.146C387.563,1434.982,387.506,1434.800,387.483,1434.612L387.483,1434.524L386.932,1431.278L386.889,1430.922L386.677,1430.655L384.938,1428.120C384.614,1427.648,384.572,1426.802,384.981,1426.119L386.677,1423.807L386.889,1423.539L386.931,1423.139L387.314,1420.160C387.319,1420.138,387.350,1420.138,387.356,1420.115C387.530,1419.419,388.049,1418.875,388.713,1418.692C388.735,1418.687,388.735,1418.654,388.755,1418.648L391.598,1418.247L391.937,1418.204L392.234,1417.981L394.652,1416.158C394.880,1415.991,395.188,1415.890,395.500,1415.890ZM404.874,1437.548L406.953,1440.884L403.685,1440.884L403.346,1441.773L402.413,1444.040L399.529,1439.415L400.164,1438.927L402.838,1438.438L402.838,1438.482C402.869,1438.476,402.889,1438.443,402.922,1438.438C403.636,1438.329,404.310,1438.022,404.874,1437.548ZZM386.126,1437.592C386.716,1438.154,387.456,1438.511,388.246,1438.615L388.288,1438.615L390.877,1438.971L391.470,1439.461L388.586,1444.040L387.653,1441.773L387.314,1440.884L384.048,1440.884Z" style="fill: rgb(29, 45, 48); fill-opacity: 1;" class="fills"/></svg></span>';
                                            echo '<span>Baixar certificado</span>';
                                            echo '</a>';
                                        } else {
                                            echo '<p><strong>Certificado ainda não disponível.</strong></p>';
                                        }
                                    }
                                    break;
                                case 'trash':
                                    $justificativa_rejeite_arquivo = get_post_meta($registro->ID, 'justificativa_rejeite_arquivo', true);
                                    $justificativa_rejeite_texto = get_post_meta($registro->ID, 'justificativa_rejeite_texto', true);

                                    if ( !$justificativa_rejeite_arquivo && !$justificativa_rejeite_texto )
                                        echo '<p><em>justificativa de indeferimento ainda não disponível.</em></p>';

                                    if ( $justificativa_rejeite_arquivo ) {
                                        echo '<a class="card-links-button" style="white-space: wrap" download="' . add_query_arg('file_id', $justificativa_rejeite_arquivo, get_stylesheet_directory_uri() . '/inc/registro-serve-file.php') . '" href="' . add_query_arg('file_id', $justificativa_rejeite_arquivo, get_stylesheet_directory_uri() . '/inc/registro-serve-file.php') . '">';
                                        echo '<span class="icon" style="color: ' . $this->get_color_by_status($registro_status) . ';"><svg width="31.333" xmlns="http://www.w3.org/2000/svg" height="31.333" viewBox="916.833 1251.833 31.333 31.333" fill="none"><path d="M932.500,1274.501C932.239,1274.501,931.994,1274.461,931.766,1274.380C931.537,1274.299,931.325,1274.160,931.129,1273.963L924.079,1266.912C923.688,1266.521,923.499,1266.064,923.515,1265.542C923.531,1265.019,923.719,1264.563,924.079,1264.171C924.471,1263.779,924.936,1263.575,925.475,1263.560C926.015,1263.544,926.479,1263.732,926.870,1264.122L930.542,1267.794L930.542,1253.792C930.542,1253.237,930.730,1252.772,931.106,1252.397C931.482,1252.023,931.946,1251.835,932.500,1251.833C933.054,1251.832,933.519,1252.020,933.896,1252.397C934.274,1252.775,934.461,1253.239,934.458,1253.792L934.458,1267.794L938.130,1264.122C938.522,1263.730,938.987,1263.542,939.526,1263.558C940.066,1263.574,940.530,1263.778,940.921,1264.171C941.280,1264.563,941.468,1265.019,941.485,1265.542C941.502,1266.064,941.314,1266.521,940.921,1266.912L933.871,1273.963C933.675,1274.158,933.463,1274.297,933.234,1274.380C933.006,1274.462,932.761,1274.502,932.500,1274.501ZM920.750,1283.167C919.673,1283.167,918.751,1282.783,917.985,1282.017C917.218,1281.251,916.835,1280.328,916.833,1279.250L916.833,1275.333C916.833,1274.778,917.021,1274.314,917.397,1273.939C917.773,1273.564,918.238,1273.376,918.792,1273.375C919.345,1273.374,919.811,1273.562,920.188,1273.939C920.565,1274.316,920.753,1274.781,920.750,1275.333L920.750,1279.250L944.250,1279.250L944.250,1275.333C944.250,1274.778,944.438,1274.314,944.814,1273.939C945.190,1273.564,945.655,1273.376,946.208,1273.375C946.762,1273.374,947.227,1273.562,947.605,1273.939C947.982,1274.316,948.169,1274.781,948.167,1275.333L948.167,1279.250C948.167,1280.327,947.783,1281.249,947.017,1282.017C946.251,1282.785,945.328,1283.168,944.250,1283.167Z" style="fill: currentColor; fill-opacity: 1;" class="fills"/></svg></span>';
                                        echo '<span>Parecer de indeferimento</span>';
                                        echo '</a>';
                                    }
                                    
                                    if ( $justificativa_rejeite_texto )
                                        echo '<p ' . ( $justificativa_rejeite_arquivo ? 'style="grid-column: 1/-1;"' : '' ) .'><strong>Justificativa de indeferimento:</strong> ' . $justificativa_rejeite_texto . '</p>';
                                    
                                    break;
                                default:
                                    break;
                            }
                        }
                        
                    } else {
    
                        if ( get_post_status($post->ID) === 'publish' ) : ?>
                            <a class="card-links-button" href="<?php echo admin_url('admin.php?page=registro&museu_id=' . $post->ID); ?>">
                                <span class="icon">
                                    <svg width="28" xmlns="http://www.w3.org/2000/svg" height="28" viewBox="-105 2129 28 28" fill="none"><path d="M-101.998,2130.500C-101.998,2129.669,-102.667,2129.000,-103.499,2129.000C-104.331,2129.000,-105.000,2129.669,-105.000,2130.500L-105.000,2155.500C-105.000,2156.331,-104.331,2157.000,-103.499,2157.000C-102.667,2157.000,-101.998,2156.331,-101.998,2155.500L-101.998,2134.763L-101.216,2134.612C-100.172,2134.412,-99.246,2134.081,-98.452,2133.794L-98.452,2133.794L-98.452,2133.794C-98.220,2133.713,-98.008,2133.631,-97.801,2133.562C-96.851,2133.237,-95.900,2132.994,-94.599,2132.994C-92.998,2132.994,-91.910,2133.369,-90.628,2133.825L-90.597,2133.838C-89.289,2134.300,-87.795,2134.831,-85.650,2134.831C-83.629,2134.831,-82.291,2134.406,-79.990,2133.606L-79.990,2148.431L-80.584,2148.637C-83.179,2149.537,-84.036,2149.837,-85.650,2149.837C-87.257,2149.837,-88.345,2149.463,-89.627,2149.006L-89.665,2148.994C-90.966,2148.531,-92.467,2148.006,-94.606,2148.006C-95.656,2148.006,-96.544,2148.131,-97.351,2148.319C-98.158,2148.506,-98.658,2149.319,-98.471,2150.125C-98.283,2150.931,-97.470,2151.431,-96.663,2151.244C-96.063,2151.106,-95.406,2151.012,-94.606,2151.012C-93.004,2151.012,-91.916,2151.388,-90.634,2151.844L-90.603,2151.856C-89.296,2152.319,-87.801,2152.850,-85.656,2152.850C-83.504,2152.850,-82.128,2152.369,-79.539,2151.463C-79.070,2151.300,-78.570,2151.125,-78.013,2150.931L-77.000,2150.588L-77.000,2149.500L-77.000,2131.500L-77.000,2129.400L-78.970,2130.081C-79.577,2130.287,-80.108,2130.475,-80.577,2130.637C-83.173,2131.537,-84.030,2131.837,-85.643,2131.837C-87.251,2131.837,-88.339,2131.462,-89.621,2131.006L-89.658,2130.994C-90.959,2130.531,-92.460,2130.006,-94.599,2130.006C-96.338,2130.006,-97.633,2130.350,-98.765,2130.731C-99.071,2130.838,-99.346,2130.937,-99.615,2131.031C-100.359,2131.300,-100.991,2131.525,-101.785,2131.675L-101.998,2131.713L-101.998,2130.500ZL-101.998,2130.500Z" style="fill: currentColor; fill-opacity: 1;" class="fills"/></svg>
                                </span>
                                <span>Iniciar Registro</span>
                            </a>
                        <?php else : ?>
                            <div class="has-text-left">
                                <p class="card-links-button has-text-warning">
                                    <span class="icon">
                                        <svg width="35" xmlns="http://www.w3.org/2000/svg" height="31" fill="none"><path d="M19.000,23.500C19.000,24.328,18.328,25.000,17.500,25.000C16.672,25.000,16.000,24.328,16.000,23.500C16.000,22.672,16.672,22.000,17.500,22.000C18.328,22.000,19.000,22.672,19.000,23.500ZM18.625,11.125C18.625,10.504,18.121,10.000,17.500,10.000C16.879,10.000,16.375,10.504,16.375,11.125L16.375,17.875C16.375,18.496,16.879,19.000,17.500,19.000C18.121,19.000,18.625,18.496,18.625,17.875Z" style="fill: rgb(252, 136, 2); fill-opacity: 1;" class="fills"/><path d="M14.198,1.888C15.668,-0.629,19.332,-0.629,20.802,1.888L34.483,25.328C35.952,27.848,34.117,31.000,31.180,31.000L3.821,31.000C0.882,31.000,-0.952,27.848,0.517,25.328ZM18.821,3.023C18.548,2.557,18.044,2.270,17.500,2.270C16.956,2.270,16.453,2.557,16.179,3.023L2.499,26.463C2.228,26.931,2.229,27.507,2.501,27.974C2.773,28.442,3.276,28.731,3.821,28.732L31.180,28.732C31.724,28.730,32.226,28.442,32.498,27.975C32.770,27.508,32.771,26.932,32.501,26.464L18.821,3.023ZZ" style="fill: rgb(252, 136, 2); fill-opacity: 1;" class="fills"/></svg>
                                    </span>
                                    <strong class="has-text-warning">Para iniciar a solicitação de Registro, é necessário que todos os campos obrigatórios, identificados com asterisco (*), estejam preenchidos no Cadastro e este esteja aprovado.</strong>
                                </p>
                            </div>
                        <?php endif;
                    }
                ?>
            </div>
        </div>
        <?php
    }

    /**
     * Gera o cartão do Formulário de Visitação
     */
    function museusbr_get_formulario_visitacao_card($post) {
        ?>
        <div class="card">
            <div class="card-header">
                <div class="card-header-icon">
                    <span class="icon">
                        <svg width="37" xmlns="http://www.w3.org/2000/svg" height="42" viewBox="1374.5 989.5 37 42" fill="none"><path d="M1390.996,989.500L1395.004,989.500C1398.491,989.500,1401.254,989.500,1403.415,989.799C1405.639,990.108,1407.439,990.756,1408.861,992.217C1410.280,993.680,1410.910,995.534,1411.210,997.824C1411.500,1000.051,1411.500,1002.893,1411.500,1006.484L1411.500,1014.516C1411.500,1018.107,1411.500,1020.951,1411.210,1023.176C1410.910,1025.466,1410.280,1027.320,1408.861,1028.783C1407.439,1030.244,1405.639,1030.892,1403.415,1031.201C1401.252,1031.500,1398.491,1031.500,1395.004,1031.500L1390.996,1031.500C1387.509,1031.500,1384.746,1031.500,1382.585,1031.201C1380.361,1030.892,1378.561,1030.244,1377.139,1028.783C1375.720,1027.320,1375.090,1025.466,1374.790,1023.176C1374.500,1020.949,1374.500,1018.107,1374.500,1014.516L1374.500,1006.484C1374.500,1002.893,1374.500,1000.049,1374.790,997.824C1375.090,995.534,1375.720,993.680,1377.139,992.217C1378.561,990.756,1380.361,990.108,1382.585,989.799C1384.748,989.500,1387.509,989.500,1390.996,989.500ZM1382.963,992.704C1381.054,992.967,1379.953,993.464,1379.149,994.290C1378.348,995.116,1377.866,996.249,1377.610,998.215C1377.348,1000.223,1377.344,1002.868,1377.344,1006.593L1377.344,1014.407C1377.344,1018.132,1377.348,1020.779,1377.610,1022.787C1377.866,1024.751,1378.348,1025.884,1379.151,1026.710C1379.953,1027.536,1381.054,1028.033,1382.963,1028.296C1384.913,1028.566,1387.482,1028.570,1391.101,1028.570L1394.896,1028.570C1398.514,1028.570,1401.085,1028.566,1403.036,1028.296C1404.942,1028.033,1406.043,1027.536,1406.846,1026.710C1407.648,1025.884,1408.130,1024.751,1408.386,1022.785C1408.648,1020.779,1408.652,1018.132,1408.652,1014.407L1408.652,1006.593C1408.652,1002.868,1408.648,1000.223,1408.386,998.213C1408.130,996.249,1407.648,995.116,1406.846,994.290C1406.043,993.464,1404.942,992.967,1403.034,992.704C1401.085,992.434,1398.514,992.430,1394.896,992.430L1391.101,992.430C1387.482,992.430,1384.913,992.434,1382.963,992.704ZM1383.987,1002.686C1383.987,1001.877,1384.624,1001.221,1385.410,1001.221L1400.590,1001.221C1401.376,1001.221,1402.013,1001.877,1402.013,1002.686C1402.013,1003.495,1401.376,1004.151,1400.590,1004.151L1385.410,1004.151C1384.624,1004.151,1383.987,1003.495,1383.987,1002.686ZM1383.987,1010.500C1383.987,1009.691,1384.624,1009.035,1385.410,1009.035L1400.590,1009.035C1401.376,1009.035,1402.013,1009.691,1402.013,1010.500C1402.013,1011.309,1401.376,1011.965,1400.590,1011.965L1385.410,1011.965C1384.624,1011.965,1383.987,1011.309,1383.987,1010.500ZM1383.987,1018.314C1383.987,1017.505,1384.624,1016.849,1385.410,1016.849L1394.897,1016.849C1395.683,1016.849,1396.321,1017.505,1396.321,1018.314C1396.321,1019.123,1395.683,1019.779,1394.897,1019.779L1385.410,1019.779C1384.624,1019.779,1383.987,1019.123,1383.987,1018.314Z" fill-rule="evenodd" clip-rule="evenodd" style="fill: rgb(255, 255, 255); fill-opacity: 1;" class="fills"/></svg>
                    </span>
                </div>
                <div class="card-header-title">
                    <h2>Formulário de Visitação Anual</h2>
                </div>
            </div>

            <div class="columns">
                <div class="column is-4">
                    <div class="card-content content">
                    O Formulário de Visitação Anual (FVA) é o instrumento pelo qual os museus devem informar ao Ibram sua visitação anual. Ele gera dados essenciais para a criação de indicadores, planejamento e formulação de políticas públicas, contribuindo para o desenvolvimento do setor museológico no Brasil.
                    </div>
                    <div class="card-content <?php echo ( get_post_status( $post ) === 'publish' ? 'panel' : 'card-links'); ?>">
                            <?php if ( get_post_status( $post ) !== 'publish' ) : ?>
                            
                                <p class="card-links-button card-links-button--registro has-text-warning">
                                    <span class="icon">
                                        <svg width="35" xmlns="http://www.w3.org/2000/svg" height="31" fill="none"><path d="M19.000,23.500C19.000,24.328,18.328,25.000,17.500,25.000C16.672,25.000,16.000,24.328,16.000,23.500C16.000,22.672,16.672,22.000,17.500,22.000C18.328,22.000,19.000,22.672,19.000,23.500ZM18.625,11.125C18.625,10.504,18.121,10.000,17.500,10.000C16.879,10.000,16.375,10.504,16.375,11.125L16.375,17.875C16.375,18.496,16.879,19.000,17.500,19.000C18.121,19.000,18.625,18.496,18.625,17.875Z" style="fill: rgb(252, 136, 2); fill-opacity: 1;" class="fills"/><path d="M14.198,1.888C15.668,-0.629,19.332,-0.629,20.802,1.888L34.483,25.328C35.952,27.848,34.117,31.000,31.180,31.000L3.821,31.000C0.882,31.000,-0.952,27.848,0.517,25.328ZM18.821,3.023C18.548,2.557,18.044,2.270,17.500,2.270C16.956,2.270,16.453,2.557,16.179,3.023L2.499,26.463C2.228,26.931,2.229,27.507,2.501,27.974C2.773,28.442,3.276,28.731,3.821,28.732L31.180,28.732C31.724,28.730,32.226,28.442,32.498,27.975C32.770,27.508,32.771,26.932,32.501,26.464L18.821,3.023ZZ" style="fill: rgb(252, 136, 2); fill-opacity: 1;" class="fills"/></svg>
                                    </span>
                                    <strong class="has-text-warning">Para inciar o FVA, o cadastro precisa ser concluido.</strong>
                                </p>

                            <?php else :
                                $ano_metadatum = new \Tainacan\Entities\Metadatum( museusbr_get_formulario_de_visitacao_ano_metadatum_id() );

                                if ( $ano_metadatum instanceof \Tainacan\Entities\Metadatum && $ano_metadatum->get_metadata_type_options() && isset($ano_metadatum->get_metadata_type_options()['options']) ) {
                                    
                                    $valores_ano = preg_split ('/\n/', $ano_metadatum->get_metadata_type_options()['options']);
                                    
                                    // Ordena valores de forma decrescente
                                    rsort($valores_ano);

                                    foreach ( $valores_ano as $ano ) {
                                        
                                        $is_current = $ano == museusbr_get_formulario_de_visitacao_ano_atual();

                                        $args = array(
                                            'post_type' => museusbr_get_formularios_de_visitacao_collection_post_type(),
                                            'posts_per_page' => 1,
                                            'meta_query' => array(
                                                array(
                                                    'key' => museusbr_get_formulario_de_visitacao_ano_metadatum_id(),
                                                    'value' => $ano,
                                                    'compare' => '='
                                                ),
                                                array(
                                                    'key' => museusbr_get_formulario_de_visitacao_museu_metadatum_id(),
                                                    'value' => $post->ID,
                                                    'compare' => '='
                                                )
                                            )
                                        );
                                        $query = new WP_Query($args);

                                        if ( $query->have_posts() ) {

                                            $query->the_post();
                                            $item = get_post();
                                            $item_status = $item->post_status;
                                            $item_status_label = $this->get_label_by_status($item_status);
                                            $item_status_color = $this->get_color_class_by_status($item_status);

                                            echo '<a class="panel-block has-text-' . $item_status_color . '" href="' . admin_url( 'admin.php?from-museu=' . $post->ID . '&page=tainacan_admin#/collections/' . museusbr_get_formularios_de_visitacao_collection_id() . '/items/' . $item->ID ) . '">';
                                            echo '<span class="panel-icon"><svg width="18" xmlns="http://www.w3.org/2000/svg" height="18" viewBox="1393.5 1247 18 18" fill="none"><path d="M1407.056,1247.000L1406.930,1247.127L1394.408,1259.649L1394.370,1259.870L1393.500,1265.000L1398.851,1264.092L1411.500,1251.444L1407.056,1247.000ZL1407.056,1247.000ZL1407.056,1247.000ZM1407.056,1248.994C1407.875,1249.846,1408.673,1250.615,1409.506,1251.444L1398.531,1262.420C1397.714,1261.600,1396.897,1260.786,1396.080,1259.969L1407.056,1248.994ZL1407.056,1248.994ZM1395.573,1261.207L1397.293,1262.927L1395.915,1263.161L1395.336,1262.603L1395.573,1261.207ZL1395.573,1261.207Z" style="fill: rgb(177, 178, 181); fill-opacity: 1;" class="fills"/></svg></span>';
                                            echo '<span ' . ( $is_current ? 'class="has-text-weight-bold"' : '' ) . '>' . esc_html( $ano ) . '</span>';
                                            echo '<span><strong>' . ( $is_current ? 'Formulário atual (' .  esc_html( $item_status_label ) . ')' : 'Formulário ' . esc_html( $item_status_label ) ) . '</strong></span>';
                                            echo $is_current ? '<span class="tag is-outlined is-succcess">Em Aplicação</span>' : '';
                                            echo '</a>';

                                        } else {
                                            echo '<a class="panel-block has-text-danger" href="' . admin_url( 'admin.php?from-ano=' . $ano . '&from-museu=' . $post->ID . '&page=tainacan_admin#/collections/' . museusbr_get_formularios_de_visitacao_collection_id() . '/items/new' ) . '">';
                                            echo '<span class="panel-icon"><svg width="19" xmlns="http://www.w3.org/2000/svg" height="19" viewBox="1391 1461 19 19" fill="none"><path d="M1400.500,1461.000C1395.262,1461.000,1391.000,1465.262,1391.000,1470.500C1391.000,1475.738,1395.262,1480.000,1400.500,1480.000C1405.738,1480.000,1410.000,1475.738,1410.000,1470.500C1410.000,1465.262,1405.738,1461.000,1400.500,1461.000ZM1400.500,1462.462C1404.948,1462.462,1408.538,1466.052,1408.538,1470.500C1408.538,1474.948,1404.948,1478.538,1400.500,1478.538C1396.052,1478.538,1392.462,1474.948,1392.462,1470.500C1392.462,1466.052,1396.052,1462.462,1400.500,1462.462ZM1399.769,1466.115L1399.769,1469.769L1396.115,1469.769L1396.115,1471.231L1399.769,1471.231L1399.769,1474.885L1401.231,1474.885L1401.231,1471.231L1404.885,1471.231L1404.885,1469.769L1401.231,1469.769L1401.231,1466.115Z" style="fill: rgb(177, 178, 181); fill-opacity: 1;" class="fills"/></svg></span>';
                                            echo '<span ' . ( $is_current ? 'class="has-text-weight-bold"' : '' ) . '>' . esc_html( $ano ) . '</span>';
                                            echo '<span><strong>Formulário ' . ( $is_current ? 'atual ' : '' ) . 'não preenchido</strong></span>';
                                            echo $is_current ? '<span class="tag is-outlined is-succcess">Em Aplicação</span>' : '';
                                            echo '</a>';
                                        }
                                        wp_reset_postdata();
                                    
                                    }

                                }
                            endif; ?>
                    </div>
                </div>
                <div class="column is-8">
                <?php echo do_shortcode('[metabase_iframe is_question=true dashboard=' . get_theme_mod('museusbr_fva_metabase_question_visitacao_id', 35) .  ' height=400 filtro_museu_id=' . $post->ID . ']'); ?>
                </div>
            </div>
        </div>
        <?php
    }

    /**
     * Obter rótulo amigável associado ao status
     */
    function get_label_by_status($post_status_slug) {
        switch ($post_status_slug) {
            case 'auto-draft':
            case 'draft':
            case 'pending':
            case 'private':
                return 'Em preenchimento';
            case 'publish':
                return 'Preenchido';
            case 'trash':
                return 'Indeferido';
            default:
                return 'Não preenchido';
        }
    }

    /**
     * Obter classe de cor associada ao status
     */
    function get_color_class_by_status($post_status_slug) {
        switch ($post_status_slug) {
            case 'auto-draft':
            case 'draft':
            case 'pending':
            case 'private':
                return 'warning';
            case 'publish':
                return 'success';
            case 'trash':
                return 'danger';
            default:
                return 'danger';
        }
    }

    /**
     * Obter cor associada ao status
     */
    function get_color_by_status($post_status_slug) {
        switch ($post_status_slug) {
            case 'auto-draft':
            case 'draft':
                return 'rgb(115, 130, 130)';
            case 'pending':
                return 'rgb(0, 122, 184)';
            case 'private':
                return 'rgb(160, 101, 34)';
            case 'publish':
                return 'rgb(26, 116, 92)';
            case 'trash':
                return 'rgb(155, 54, 54)';
            default:
                return 'rgb(115, 130, 130)';
        }
    }


    /**
     * Remove a coluna padrão de título e cria uma especial
     */
    function set_custom_museu_title_column($columns) {
        
        unset($columns['title']);
        
        if ( isset($columns['museu_certificado']) )
            unset($columns['museu_certificado']);

        if ( isset($columns['museu_registro']) )
            unset($columns['museu_registro']);

        $columns['museu_admin'] = 'Lista de museus';
        $columns['museu_links'] = 'Ações rápidas';

        $new_columns = array();
        $new_columns['cb'] = $columns['cb'];
        $new_columns['museu_admin'] = 'Lista de museus';
        $new_columns['museu_links'] = 'Ações rápidas';
        $new_columns['author'] = $columns['author'];
        $new_columns['date'] =  $columns['date'];
       
        return $new_columns;
    }

    /**
     * Exibe uma coluna de título diferente nas tabelas dos museus
     */
    function museu_custom_title_column($column_name) {
        global $post;

        if ( $column_name == 'museu_admin' ) { ?>
            <div class="museu-admin-main-row">
                <strong>
                    <a class="row-title" href="<?php echo admin_url( 'admin.php?page=museu&post=' . $post->ID ); ?>">
                    
                        <?php if (has_post_thumbnail($post)) : ?>
                            <figure class="image ml-2" style="flex-shrink: 0;">
                                <?php echo get_the_post_thumbnail($post, 'tainacan-small'); ?>
                            </figure>
                        <?php else : ?>
                            <figure class="image ml-2" style="flex-shrink: 0;">
                                <svg xmlns="http://www.w3.org/2000/svg" fill="none" height="22" viewBox="-2 -2 22 22" width="22"><path d="M9.000,18.000L9.000,9.750M12.750,18.000L12.750,9.750M5.250,18.000L5.250,9.750M0.000,6.000L9.000,0.000L18.000,6.000M16.500,18.000L16.500,7.332C14.019,6.944,11.511,6.749,9.000,6.750C6.449,6.750,3.944,6.950,1.500,7.332L1.500,18.000M0.000,18.000L18.000,18.000M9.000,3.750L9.000,3.750ZL9.000,3.750ZL9.000,3.750ZL9.000,3.750ZZ" style="fill: none;" class="fills"></path><g stroke-linejoin="round" class="strokes"><path d="M9.000,18.000L9.000,9.750M12.750,18.000L12.750,9.750M5.250,18.000L5.250,9.750M0.000,6.000L9.000,0.000L18.000,6.000M16.500,18.000L16.500,7.332C14.019,6.944,11.511,6.749,9.000,6.750C6.449,6.750,3.944,6.950,1.500,7.332L1.500,18.000M0.000,18.000L18.000,18.000M9.000,3.750L9.000,3.750ZL9.000,3.750ZL9.000,3.750ZL9.000,3.750ZZ" style="fill: none; stroke-width: 2; stroke: rgb(177, 178, 181); stroke-opacity: 1;" class="stroke-shape"></path></g></svg>
                            </figure>
                        <?php endif; ?>
                        <?php echo $post->post_title; ?>
                    </a>
                </strong>
                <a class="wp-button button wp-button-has-icon" style="white-space: wrap" href="<?php echo admin_url( 'admin.php?page=museu&post=' . $post->ID ); ?>">
                    <svg width="26.5" xmlns="http://www.w3.org/2000/svg" height="26.5" id="screenshot-22db9728-c85b-8009-8006-1fdfe885663e" viewBox="614.75 3682.75 26.5 26.5" xmlns:xlink="http://www.w3.org/1999/xlink" fill="none" version="1.1"><g id="shape-22db9728-c85b-8009-8006-1fdfe885663e"><g class="fills" id="fills-22db9728-c85b-8009-8006-1fdfe885663e"><path d="M629.500,3700.875L632.875,3700.875M632.875,3700.875L636.250,3700.875M632.875,3700.875L632.875,3697.500M632.875,3700.875L632.875,3704.250M622.000,3694.500L624.250,3694.500C625.493,3694.500,626.500,3693.493,626.500,3692.250L626.500,3690.000C626.500,3688.757,625.493,3687.750,624.250,3687.750L622.000,3687.750C620.757,3687.750,619.750,3688.757,619.750,3690.000L619.750,3692.250C619.750,3693.493,620.757,3694.500,622.000,3694.500ZZM622.000,3704.250L624.250,3704.250C625.493,3704.250,626.500,3703.243,626.500,3702.000L626.500,3699.750C626.500,3698.507,625.493,3697.500,624.250,3697.500L622.000,3697.500C620.757,3697.500,619.750,3698.507,619.750,3699.750L619.750,3702.000C619.750,3703.243,620.757,3704.250,622.000,3704.250ZZM631.750,3694.500L634.000,3694.500C635.243,3694.500,636.250,3693.493,636.250,3692.250L636.250,3690.000C636.250,3688.757,635.243,3687.750,634.000,3687.750L631.750,3687.750C630.507,3687.750,629.500,3688.757,629.500,3690.000L629.500,3692.250C629.500,3693.493,630.507,3694.500,631.750,3694.500ZZ" fill="none" stroke-linejoin="round" style="fill: none;"/></g><g fill="none" stroke-linejoin="round" id="strokes-706fc2c7-cfdf-800b-8006-23ad3a6a2664-22db9728-c85b-8009-8006-1fdfe885663e" class="strokes"><g class="stroke-shape"><path d="M629.500,3700.875L632.875,3700.875M632.875,3700.875L636.250,3700.875M632.875,3700.875L632.875,3697.500M632.875,3700.875L632.875,3704.250M622.000,3694.500L624.250,3694.500C625.493,3694.500,626.500,3693.493,626.500,3692.250L626.500,3690.000C626.500,3688.757,625.493,3687.750,624.250,3687.750L622.000,3687.750C620.757,3687.750,619.750,3688.757,619.750,3690.000L619.750,3692.250C619.750,3693.493,620.757,3694.500,622.000,3694.500ZZM622.000,3704.250L624.250,3704.250C625.493,3704.250,626.500,3703.243,626.500,3702.000L626.500,3699.750C626.500,3698.507,625.493,3697.500,624.250,3697.500L622.000,3697.500C620.757,3697.500,619.750,3698.507,619.750,3699.750L619.750,3702.000C619.750,3703.243,620.757,3704.250,622.000,3704.250ZZM631.750,3694.500L634.000,3694.500C635.243,3694.500,636.250,3693.493,636.250,3692.250L636.250,3690.000C636.250,3688.757,635.243,3687.750,634.000,3687.750L631.750,3687.750C630.507,3687.750,629.500,3688.757,629.500,3690.000L629.500,3692.250C629.500,3693.493,630.507,3694.500,631.750,3694.500ZZ" style="fill: none; stroke-width: 2; stroke: rgb(177, 178, 181); stroke-opacity: 1;"/></g></g></g></svg>
                    <span>Painel</span>
                </a>
            </div>
        <?php } else if ( $column_name == 'museu_links' ) { ?>
            <div class="museu-admin-links-row">
                <?php if ( current_user_can( 'edit_post', $post->ID ) ) : ?>
                    <a class="wp-button button wp-button-has-icon" style="white-space: wrap" href="<?php echo get_edit_post_link( $post->ID ); ?>">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" height="22" viewBox="-2 -2 22 22" width="22"><path d="M9.000,18.000L9.000,9.750M12.750,18.000L12.750,9.750M5.250,18.000L5.250,9.750M0.000,6.000L9.000,0.000L18.000,6.000M16.500,18.000L16.500,7.332C14.019,6.944,11.511,6.749,9.000,6.750C6.449,6.750,3.944,6.950,1.500,7.332L1.500,18.000M0.000,18.000L18.000,18.000M9.000,3.750L9.000,3.750ZL9.000,3.750ZL9.000,3.750ZL9.000,3.750ZZ" style="fill: none;" class="fills"></path><g stroke-linejoin="round" class="strokes"><path d="M9.000,18.000L9.000,9.750M12.750,18.000L12.750,9.750M5.250,18.000L5.250,9.750M0.000,6.000L9.000,0.000L18.000,6.000M16.500,18.000L16.500,7.332C14.019,6.944,11.511,6.749,9.000,6.750C6.449,6.750,3.944,6.950,1.500,7.332L1.500,18.000M0.000,18.000L18.000,18.000M9.000,3.750L9.000,3.750ZL9.000,3.750ZL9.000,3.750ZL9.000,3.750ZZ" style="fill: none; stroke-width: 2; stroke: rgb(177, 178, 181); stroke-opacity: 1;" class="stroke-shape"></path></g></svg>
                        <span>Editar cadastro</span>
                    </a>
                <?php endif; ?>
                <a class="wp-button button wp-button-has-icon" style="white-space: wrap" href="<?php echo get_post_permalink( $post->ID ); ?>">
                    <svg width="27" xmlns="http://www.w3.org/2000/svg" height="20" fill="none"><path d="M26.946,9.691C24.783,4.038,19.496,0.228,13.500,0.000C7.504,0.228,2.217,4.038,0.054,9.691C-0.018,9.891,-0.018,10.109,0.054,10.309C2.217,15.962,7.504,19.772,13.500,20.000C19.496,19.772,24.783,15.962,26.946,10.309C27.018,10.109,27.018,9.891,26.946,9.691ZM13.500,18.182C8.730,18.182,3.690,14.609,1.863,10.000C3.690,5.391,8.730,1.818,13.500,1.818C18.270,1.818,23.310,5.391,25.137,10.000C23.310,14.609,18.270,18.182,13.500,18.182ZM13.500,4.545C10.518,4.545,8.100,6.988,8.100,10.000C8.100,13.012,10.518,15.455,13.500,15.455C16.482,15.455,18.900,13.012,18.900,10.000C18.900,6.988,16.482,4.545,13.500,4.545ZM13.500,13.636C11.512,13.636,9.900,12.008,9.900,10.000C9.900,7.992,11.512,6.364,13.500,6.364C15.488,6.364,17.100,7.992,17.100,10.000C17.100,12.008,15.488,13.636,13.500,13.636Z" style="fill: rgb(177, 178, 181); fill-opacity: 1;" class="fills"/></svg>
                    <span>Ver online</span>
                </a>
                <!-- <?php if ( MUSEUSBR_ENABLE_CERTIFICADO_CADASTRO && get_post_status( $post ) === 'publish' ) :
                    $certificado_icon = '<svg width="24" xmlns="http://www.w3.org/2000/svg" height="26" viewBox="379 1413 33 37" fill="none"><path d="M395.500,1413.000C394.652,1413.000,393.809,1413.299,393.083,1413.845L390.835,1415.490L388.245,1415.846L388.203,1415.846L388.161,1415.890C386.427,1416.299,385.072,1417.719,384.682,1419.538L384.641,1419.582L384.641,1419.626L384.302,1422.384L382.733,1424.518L382.689,1424.563L382.689,1424.607C381.740,1426.196,381.698,1428.248,382.733,1429.765L384.344,1432.122L384.769,1434.570L380.399,1441.550L379.000,1443.730L385.490,1443.730L387.059,1447.554L388.035,1450.000L389.434,1447.776L393.718,1441.016C394.869,1441.511,396.168,1441.557,397.282,1441.016L401.566,1447.776L402.965,1450.000L403.941,1447.554L405.510,1443.730L412.000,1443.730L410.601,1441.550L406.359,1434.792L406.698,1432.123L408.267,1429.767L408.311,1429.723L408.311,1429.678C409.260,1428.089,409.302,1426.081,408.267,1424.564L406.698,1422.206L406.189,1419.538L406.231,1419.538C406.226,1419.503,406.195,1419.481,406.189,1419.448C405.945,1417.587,404.540,1416.075,402.754,1415.846L402.710,1415.846L400.165,1415.490L397.917,1413.845C397.216,1413.306,396.370,1413.010,395.500,1413.000ZM395.500,1415.890C395.812,1415.890,396.120,1415.990,396.348,1416.158L398.766,1417.981L399.063,1418.203L399.402,1418.248L402.372,1418.692L402.413,1418.692C403.024,1418.763,403.447,1419.209,403.517,1419.849L403.517,1419.938L404.069,1423.095L404.110,1423.407L404.323,1423.673L406.062,1426.208C406.386,1426.680,406.428,1427.481,406.019,1428.164L404.111,1430.966L404.068,1431.322L403.644,1434.436L403.644,1434.479C403.621,1434.701,403.549,1434.914,403.432,1435.102L403.347,1435.147L403.347,1435.190C403.145,1435.444,402.856,1435.604,402.542,1435.635L402.456,1435.635L399.360,1436.215L399.021,1436.257L398.766,1436.481L396.348,1438.304C395.898,1438.644,395.091,1438.688,394.440,1438.260L392.234,1436.481L391.979,1436.259L391.598,1436.213L388.628,1435.769L388.587,1435.769C388.198,1435.732,387.850,1435.500,387.653,1435.146C387.563,1434.982,387.506,1434.800,387.483,1434.612L387.483,1434.524L386.932,1431.278L386.889,1430.922L386.677,1430.655L384.938,1428.120C384.614,1427.648,384.572,1426.802,384.981,1426.119L386.677,1423.807L386.889,1423.539L386.931,1423.139L387.314,1420.160C387.319,1420.138,387.350,1420.138,387.356,1420.115C387.530,1419.419,388.049,1418.875,388.713,1418.692C388.735,1418.687,388.735,1418.654,388.755,1418.648L391.598,1418.247L391.937,1418.204L392.234,1417.981L394.652,1416.158C394.880,1415.991,395.188,1415.890,395.500,1415.890ZM404.874,1437.548L406.953,1440.884L403.685,1440.884L403.346,1441.773L402.413,1444.040L399.529,1439.415L400.164,1438.927L402.838,1438.438L402.838,1438.482C402.869,1438.476,402.889,1438.443,402.922,1438.438C403.636,1438.329,404.310,1438.022,404.874,1437.548ZZM386.126,1437.592C386.716,1438.154,387.456,1438.511,388.246,1438.615L388.288,1438.615L390.877,1438.971L391.470,1439.461L388.586,1444.040L387.653,1441.773L387.314,1440.884L384.048,1440.884Z" style="fill: rgb(177, 178, 181); fill-opacity: 1;" class="fills"/></svg>';
                    MUSEUSBR_Certificado_Page::render_certificado_button( $post, 'wp-button button wp-button-has-icon', $certificado_icon ); 
                endif; ?> -->
            </div>
        <?php }
    }

    /**
     * Remove a opção de edição rápida para o post type 'registro'
     */
    function remove_quick_edit($actions, $post) {
        if ( $post->post_type == museusbr_get_museus_collection_post_type() ) {
            unset($actions['inline hide-if-no-js']);
            unset($actions['view']);
        }

        return $actions;
    }
    
    // Remover ações em massa
    function remove_bulk_actions($actions) {
        if ( museusbr_user_is_gestor() )
            return array();

        return $actions;
    }
	
    // Remove opções de tela
    function remove_screen_options( $show_screen, $screen ) { 
        
        if (
            $screen->id === 'edit-' . museusbr_get_museus_collection_post_type() ||
            $screen->id === 'admin_page_museu' ||
            $screen->id === 'admin_page_registro'
        )
            return false;
        
        return $show_screen; 
    }

}
